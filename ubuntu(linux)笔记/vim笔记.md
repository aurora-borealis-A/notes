# 一、绪论

## 1.vi和vim简介

### 1.1 vi

vi是"visual interface"的缩写，用于在终端窗口编辑文本或程序。

vi被设计时追求开发的迅速高效，因此使用vi时只用到键盘的核心区域，即字母区及一点其他附近的按键（如Esc等），鼠标与方向键都没有用。同时以命令行形式来操作文件。

### 1.2 vim

vim是在vi的基础上增加了一些代码补全等功能的编辑器，更利于程序员开发。vim的m是”improved“的缩写，意味着改进版。

vi和vim是**两个不同的编辑器**，vim是vi的改进版，但是大多数人都在用vim，vi很少用，因此大多数Linux系统都把**vi作为vim的软链接**，即在命令行中指令`vi`和`vim`的功能一样，都是运行vim。



## 2、打开或新建

格式：`vim 文件名 [+num]`。

说明：用vim编辑器打开文件，如果文件不存在则新建文件并编辑，如果文件已存在则直接编辑。在末尾加上 `+num`，可以使打开文件后光标定位在第num行，如果不写num，则光标在末尾。

例如：

```
vim hello.py  # 打开或新建hello.py，然后开始编辑
vim hello.py +4  # 打开hello.py，光标在第4行开头
vim hello.c +  # 打开hello.c，光标在文件末尾
```

注意：

- 如果编辑时，vim异常退出（例如文件未保存而终端窗口被强行关闭），会留下交换文件（隐藏文件），再用vim打开刚才正在编辑的文件时，会有提示，此时按下d即可，即删除交换文件。
- 交换文件是vim运行时的中间文件，用于提高vim的运行速度的，如果vim正常运行，本应该不会留下交换文件。



## 3、工作模式

三种工作模式：

- 命令行模式：编辑入口，刚进编辑界面时就是命令行模式，可以在命令模式下进行查找、复制、定位等操作。
- 插入模式：就是普通的文本插入模式。
- 末行模式：编辑出口，可以实现保存、退出等操作。

模式切换：

- 命令行模式下按`i`，进入插入模式。
- 命令行模式下按`:`，进入末行模式。
- 在插入模式、末行模式下按`Esc`：进入命令行模式。
- **插入模式和末行模式之间没法直接切换**，得通过命令行模式过渡。

编辑流程：

1. 刚进编辑界面时为命令行模式，通过命令定位光标，然后按`i`，进入插入模式。
2. 在插入模式下完成编辑，然后按`Esc`回到命令行模式。
3. 在命令行模式再定位到下一处要编辑的地方，或者做复制等其他操作，然后又进入插入模式。
4. 重复第二步和第三步，直到不需要文件全部编辑完成，在命令行模式下按`:`，进入末行模式，准备保存于退出。



# 二、末行模式

## 1. 常用命令

| 命令 | 功能                                 |
| ---- | ------------------------------------ |
| :w   | 保存（写入）                         |
| :q   | 退出                                 |
| :!q  | 强制退出（因为默认没有保存无法退出） |
| :wq  | 保存并退出（常用）                   |
| :x   | :wq的简写，保存并退出                |

## 2. 文件命令

| 命令      | 英文  | 功能                                                         |
| --------- | ----- | ------------------------------------------------------------ |
| :e 文件名 | edit  | vim打开另一个文件，相当于切换文件                            |
| :e .      | edit  | “.”表示当前文件夹，会自动打开vim内置的文件浏览器，以供选择文件并打开 |
| :n 文件名 | new   | 创建一个名叫“文件名”的新文件，然后编辑新文件                 |
| :w 文件名 | write | 把当前文件写入一个名为”文件名“的文件，相当于另存为           |

**注意：**

- 使用`:e`切换文件时，要先保存，否则不允许切换。
- `:w`另存为时，并不会打开新文件，常用于阶段性的备份工作。例如：编写完程序的一段后，输入`:w stage1`以将当前内容备份在文件stage1中，然后继续当前文件的编写。



## 3. 执行终端命令

在末行模式下，`!`表示接下来的命令是终端命令

例如：

- `:!ls`：在vim中执行ls命令。
  - 会暂时退出vim的界面，返回到bash界面执行命令。



## 4. 分屏

**分屏命令**：

| 命令          | 英文           | 功能                                                         |
| ------------- | -------------- | ------------------------------------------------------------ |
| :sp [文件名]  | split          | 水平分屏，分屏中打开名叫“文件名”的文件<br />如果不指定打开的文件，则再打开当前文件<br />文件名可以为”.“，会打开vim内置的文件浏览器来选择文件 |
| :vsp [文件名] | vertical split | 垂直分屏                                                     |

**切换窗口**：

- 首先按下`Ctrl + w`，意为"control window"。
- 输入屏幕操作指令：
  - `h`、`j`、`k`、`l`：切换到第左、下、上、右个窗口。
  - `w`（window）：切换到下一个窗口。
  - `r`（reverse）：交换两个窗口（多个窗口向后循环滚动，即最后的窗口移动到第一个窗口，剩下的窗口后退）。
  - `c`（close）：关闭当前窗口，如果是最后一个窗口则不做反应。
  - `q`（quit）：关闭当前窗口，如果是最后一个窗口则退出vim。
  - `o`（other）：关闭除当前窗口外的其他窗口。
- 也可以通过命令`:ls`来查看当前所有窗口的序号
  - 然后通过`Ctrl + w 序号 w`的方式，指定跳转的窗口。

**移动窗口**：

- 按下`Ctrl + w`后，接下**大写的方向键**：`h`、`j`、`k`、`l`，就能使得当前窗口与对应方向的窗口交换。



# 三、命令模式

## 1. 通用指令

`数字n + 命令`：表示重复执行命令n次。

## 2. 移动光标

### 2.1 上下左右

| 命令                 | 功能         |
| -------------------- | ------------ |
| j                    | 光标向下移动 |
| k                    | 向上         |
| h                    | 向左         |
| l（这个字符大写是L） | 向右         |

### 2.2 行内移动

| 命令     | 英文     | 功能                                     |
| -------- | -------- | ---------------------------------------- |
| b        | backward | 光标后退一个单词                         |
| w        | word     | 前进一个单词                             |
| t + 字符 | to       | 向后跳转到（同行的）指定字符的前一个字符 |
| T + 字符 | to       | 与t命令类似，但是向前跳转                |
| 0        |          | 行首                                     |
| ^        |          | 字符行首                                 |
| $        |          | 行尾                                     |

### 2.3 行间移动

| 命令            | 英文 | 功能       |
| --------------- | ---- | ---------- |
| gg              | go   | 文件顶部   |
| G               | go   | 文件末尾   |
| 20gg            | go   | 跳到第20行 |
| 20G             | go   | 跳到第20行 |
| :20（末行模式） | go   | 跳到第20行 |

记住一个g（go）就可以。

### 2.4 屏幕移动

| 命令     | 英文     | 功能     |
| -------- | -------- | -------- |
| Ctrl + b | backward | 向上滚屏 |
| Ctrl + f | forward  | 向下滚屏 |
| H        | head     | 屏幕头部 |
| M        | middle   | 屏幕中间 |
| L        | low      | 屏幕底部 |

### 2.5 程序段间移动

一段没有空行的程序，称为一段程序。

| 命令 | 功能       | 说明                                                         |
| ---- | ---------- | ------------------------------------------------------------ |
| {    | 跳到上一段 | 程序段上一行                                                 |
| }    | 跳到下一段 | 程序段下一行                                                 |
| %    | 括号匹配   | 跳到另一个匹配的括号上<br />括号包括：[]、()、{}<br />如果在括号内，则跳到前括号上 |

### 2.6 标记

| 命令 | 英文                   | 功能                                               |
| ---- | ---------------------- | -------------------------------------------------- |
| mx   | mark                   | 给当前行打上标记x，x可以是任意英文字母，区分大小写 |
| `x | "**`**"就是quote的意思 | 跳转到标记为x的行                                  |
| `` | quote | 跳转到本次光标跳转前的位置 |

**注意：**

- 不用去管标记删除的事，vim会自动帮我们管理。
- 当被标记的行被删除时，对应的标记会被自动删除。
- 如果别的行被贴上了同样的标记x，原来被标记x的行就丢掉标记。

## 3. 文本操作

### 3.1 选中文本（可视模式）

| 命令     | 英文   | 功能       |
| -------- | ------ | ---------- |
| v        | visual | 可视模式   |
| V        | visual | 可视行模式 |
| Ctrl + v | visual | 可视块模式 |

**注意：**

- 可视模式也是一种工作模式。
- 从可视模式退回到命令模式行模式，用`Esc`。

### 3.2 撤销和恢复

| 命令     | 英文 | 功能 |
| -------- | ---- | ---- |
| u        | undo | 撤销 |
| Ctrl + r | redo | 恢复 |

**注意：**

- 撤销操作可以一直撤销到文件被修改前的状态，即刚打开文件时的状态。

### 3.3 删除

| 命令         | 英文   | 功能                                             |
| ------------ | ------ | ------------------------------------------------ |
| x            | cut    | 删除选中的文本，或当前光标所在的字符             |
| d + 移动命令 | delete | 删除当前光标所在位置到移动命令落点位置之间的字符 |
| dd           | delete | 删除当前行                                       |
| D            | delete | 删除到行末                                       |

d与移动命令的**常用搭配**：

- dw：删除到单词结尾.
  - diw：iw表示"inner word"，删除当前光标所在的单词。
- d}：删除到程序段结尾。
- ndd：连续删除n行。
- d0：删除到行首。
- d10G：删除到第10行。
- dG：删除到文件结尾。
- d`a：删除到标号a所在的行。
- dta：删除到下一个字符a。

**注意：**

- 如果有选中的文本，则`x`和`d`都是删除选中文本的作用。
- 这里的删除实际上是**剪切。**

### 3.4 复制与粘贴

| 命令         | 英文  | 功能                                                         |
| ------------ | ----- | ------------------------------------------------------------ |
| y + 移动命令 | yank  | 复制当前光标所在位置到移动命令落点位置之间的字符，用法和d命令一样 |
| yy           | yank  | 复制当前行                                                   |
| Y            | yank  | 复制当前行                                                   |
| p            | paste | 粘贴                                                         |

**注意：**

- 复制与删除（剪切）实际上都是把文本复制到vim的文本缓冲区中。
- 文本缓冲区与剪切板的作用一样，但是vim的文本缓冲不是系统的剪切板。
- 从别的文件Ctrl + c复制的内容，无法用p命令粘贴到文本中，需要切换到插入模式下才能使用系统的剪切板粘贴。

### 3.5 替换

| 命令       | 英文    | 功能                               |
| ---------- | ------- | ---------------------------------- |
| c+移动命令 | change  | 删除光标经过的文本，并进入插入模式 |
| cc         | change  | 删除当前行，并进入插入模式         |
| C          | change  | 删除到行尾，并进入插入模式         |
| r          | replace | 替换当前字符                       |
| R          | replace | 进入替换模式，替换当前及以后的字符 |

**注意：**

- 替换可以在不进入插入模式下，对文本做改动，适合文本需要微量修改的情况。

### 3.6 缩排和重复

| 命令 | 功能            |
| ---- | --------------- |
| >>   | 向右缩进4个空格 |
| <<   | 向左缩进4个空格 |
| .    | 重复上一个指令  |

连续缩进：

- 在可视模式下，选择一段程序，然后按`>`缩进（可视模式下一个`>`就够了）。
- 再按`.`，就能再次缩进
- 取消缩进的步骤也类似

### 3.7 查找

#### 3.7.1 常规查找

`/str`：查找字符串str，并高亮显示。

`n`：光标跳到**下一个**查找到的对象。

`N`：光标跳到**上一个**查找到的对象。

**注意：**

- 查找后高亮显示一直存在，如果要**取消高亮**，任意查找一个不存在的字符。

#### 3.7.2单词匹配

`*`：向后查找当前光标所在的单词。

`#`：向前查找当前光标所在的单词。

### 3.8 查找替换

需要进入**末行模式**进行查找与替换。

**基本格式**：`:搜索范围/旧文本/新文本/选项`。

- 搜索范围：

  - `s`：substitude，表示搜索满园为当前行，或者当前选中的可视区域。
  - `%s`：表示文本搜索范围是所有行，即整个文件。

- 选项：

  - `g`：global，表示替换的作用范围为全局（一行的全局）。
    - 如果不加g，如只替换一行中第一个匹配的字符。
  - `c`：confirm，表示替换前会向你确认：
    - y：yes，替换
    - n：no，不替换
    - a：all，全部替换
    - q：quit，退出
    - l：last，最后一个替换，并把光标移到行首
    - ^E：Ctrl + E，向下滚屏
    - ^Y：Ctrl + F，向上滚屏

  - 几点说明：
    - vim搜索文本是以行为单位的。
    - 例如：%s/apple/banana：
      - vim会**逐行搜索**apple，并将每一行第一个找到的apple替换为banana；
      - **而不是**将全文中的第一个apple替换为banana，其他apple保持不变；
      - **也不是**将每行的所有的apple替换为banana。



# 四、插入模式

## 1. 进入插入模式的方式

在命令模式下，按下相应的快捷键相进行一些操作（如光标跳转、删除文本），再进入到插入模式，此时可以正常输入文本。根据进入插入模式前执行的操作，命令可以分为：

- 光标跳转：

  - `i`：insert，不移动光标，直接进入插入模式。
  - `I`：insert，移动光标到行首，并进入插入模式。
  - `a`：append，光标往后移动一个字符，然后进入插入模式。
  - `A`：append，光标跳转到行尾，然后进入插入模式。
  - `o`：open（a new line），向上创建新的一行，然后进入插入模式。
  - `O`：open（a new line），向下创建新的一行，然后进入插入模式。

- 修改文本：

  - `s`：substitute，删除当前光标所在字符，然后进入插入模式。

  - `S`：删除光标所在的整行，然后进入插入模式。

  - `c`：change，删除光标经过的文本，然后进入插入模式。

    - 类似于d命令，在输入c命令后需要跟上光标移动命令。
    - 例如：`cw`，就是删除下一个单词，然后进入插入模式。

    - `ciw`：删除当前光标所在单词，然后进入插入模式。
    - 具体与c有关的命令可以查看本章3.5节。

## 2. 示例

### 2.1 重复输入

输入5个星”*“：

- 在命令行模式下输入5，然后按`i`进入插入模式。
- 在插入模式下输入一个“*”，然后`Esc`回到命令行模式。
- vim会自动补全4个“\*”，总共5个“*”。
- 接着按下`.`，重复上个命令，或再生成5个*
- 这个做法相当于使用了`数字n + 命令`的语法

**注意：**

- 正常开发时，进入插入模式前不要按数字，否则会把多余的代码复制好几份，删除会很麻烦

### 2.2 多行代码注释

对一段代码一起注释：

- 进入可视块模式，选择一段代码。
- 按`I`进入插入模式（按`i`没有用），光标会定位到可视块的第一行。
- 然后我们可以输入'"#"或"/"等注释符号。
- 退出插入模式时，会自动把选择的其他行也加上注释符号。





# 五、 高级设置

vim中，可以在末行模式下设置一些参数，来进行一些高级设置。

## 5.0 查看参数

`:set 参数名称?`：查看参数的当前值。

:help 参数名称：查看参数的帮助文档。



## 5.1 设置行号

`:set nu`：显示行号

`:set nonu`：不显示行号

- nu是"number“的速写。
- 该命令临时有效，只能在此次打开中有效。
- 如果要永久有效，需要在家目录下 创建`.vimrc`文件（已存在就不用创建），在其中添加`set nu`。

## 5.2 设置缩进

- `set tabstop=宽度`：设置`tab`键的宽度。
- `set shiftwidth=宽度`：设置`>>`与`<<`命令的宽度。
- `set expandtab`：将`tab`转换为空格：。
  - `set noexpandtab`：用于取消将tab转为空格，适合于编写Makefile。
- `set breakindent`：自动换行后新行保持缩进。
- `set showbreak=↪`：指定一个字符串`↪`，用于在换行处显示，以区分真正的换行和自动换行。

注意：

- 上面这些命令只对当前所在的vim窗口有效，如果希望永久有效，需要修改添加这些命令到`~/vimrc`文件。

## 5.3 快捷键映射

### 5.3.1 添加映射方法

在vim中，如果一些快捷键太繁琐，可以使用快捷键映射的方式，**给已存在的vim快捷键取别名**，使其简化。

在`~/.vimrc`文件中使用`nnoremap`命令来添加快捷键映射，例如：

- `nnoremap <C-h\> <C-w\>h`：
  - 将原屏幕移动命令`Ctrl + w` + `h` 
  - 映射为 `Ctrl + h`。
- nnoremap <A-w\> <C-w\>w：
  - 将原屏幕切换命令`Ctrl + w` + `w`
  - 映射为`Alt + w`。

**nnoremap命令解释**：

- n：表示normal mode，普通模式；
  - 其他模式还有:
  - v：可视模式；
  - i：插入模式；
  - c：命令行模式。
- nore：表示no recursion，非递归映射，即新定义的快捷键不会触发其他快捷键。
  - 若希望递归映射，则不需要nore，
  - 例如：`nmap`，则表示普通模式下递归映射。
- map：表示映射

### 5.3.2 组合键、特殊键和功能键

vim中的组合键、特殊键和功能键都用尖括号`<>`包围起来。

---

**组合键**语法：<修饰键-普通键>

- 修饰键：

  - `C`：表示`ctrol`键；

  - `S`：表示`shift`键；

  - `A`：表示`alt`键。

- 例如：
  - `<C-w\>`：表示组合键`Ctrl + w`；
  - `<A-h\>`：表示组合键`Alt + w`；
  - `<C-S-a\>`：表示组合键`Ctrl + Shift + a`。
- 组合键后可以再跟普通键，例如：
  - <C-w\>w：表示`Ctrl + w` + `w`。

---

**特殊键**：

- `<tab\>`：Tab键；
- `<Esc\>`：Escape键；
- `<Enter\>`：回车键；
- `<Space\>`：空格键；
- `<BS\>`：BackSpace键；
- `<Up\>`、`<Down\>`、`<Left\>`、`<Right\>`：方向键。

---

**功能键**：

- `<F1>` ~ `<F12>`：F1 ~ F12功能键。



## 5.4 设置文件类型

有时在使用vim编辑一些文件时，vim可以会无法识别一些文件的格式，例如：编写c++省略后缀名.h的头文件时，vim无法知道你在编写的是c++头文件。此时需要显示地指定当前编写的文件类型：

- `set filetype=文件类型`
  - 例如：
    - `set filetype=cpp`，指定当前编写的文件类型是c++文件（包括c++头文件）。

## 5.5 自动命令

在vim中，可以使用`autocmd`命令，实现自动触发一些命令，例如根据文件类型来调整当前的vim设置。

格式：`autocmd 事件 条件 命令`

作用：

- 如果事件满足条件，就执行命令。

参数解释：

- 事件：
  - `BufRead`：读取文件；
  - `BufWrite`：写入文件；
  - `BufNewFile`：创建新文件；
  - `FileType`：文件类型；
  - `BufEnter`：进入缓冲区；
  - `BufLeave`：离开缓冲区。
  - 完整的事件列表可以用在vim中用命令`:help autocmd-events`查看
- 条件:
  - `*`：匹配任意文件名；
  - `*.c`、`\*.py`：匹配特定后续名的文件；
  - 固定文件类型：`c`、`python`、`make`等。
    - 与事件`FileType`连用。
- 例如：
  - `autocmd FileType make setlocal noexpandtab tabstop=4`
    - 如果文件类型是makefile的话，取消扩展为空格的功能，并且设置tab键的宽度为4个空格。


## 5.6 颜色设置

### 5.6.1 vim内置颜色

在vim终端中，总共预先定义了16种颜色，分别为：

- `White`：白色；
- `Black`：黑色；
- `Cyan`：青色；
- `Magenta`：洋红色；
- `Blue`：蓝色；
- `Yellow`：黄色；
- `Green`：绿色；
- `Red`：红色；

---

- `LightGray`：浅灰色；
- `DarkGray`：深灰色；
- `DarkCyan`：深青色；
- `DarkMagenta`：深洋红色；
- `DarkBlue`：深蓝色；
- `DarkYellow`：深黄色；
- `DarkGreen`：深绿色；
- `DarkRed`：深红色。

### 5.6.2 内置颜色主题

### 5.6.3 自定义颜色设置

除了使用vim内置的颜色与颜色主题，可以使用`highlight`命令来定义颜色：

- 格式：`highlight 语法高亮组 ctermfg=颜色 ctermbg=颜色 guifg=颜色 guimg=颜色`

  - 简写：`hi`

- 作用：设置vim在终端和gui下，语法高亮组的前景与背景色。

- 语法高亮组：

  | 名称           | 说明                                        | 名称             | 说明                                 |
  | -------------- | ------------------------------------------- | ---------------- | ------------------------------------ |
  | `Comment`      | 注释（如 `#`、`//`、`/* */` 等）            | `Constant`       | 常量（如数字、字符、字符串等）       |
  | `String`       | 字符串（如 `"hello"`、`'world'` 等）        | `Character`      | 字符（如 `'a'`、`'\n'` 等）          |
  | `Number`       | 数字（如 `123`、`3.14` 等）                 | `Boolean`        | 布尔值（如 `true`、`false` 等）      |
  | `Float`        | 浮点数（如 `3.14`、`0.5` 等）               | `Identifier`     | 标识符（如变量名、函数名等）         |
  | `Function`     | 函数名                                      | `Statement`      | 语句（如 `if`、`else`、`return` 等） |
  | `Conditional`  | 条件语句（如 `if`、`else`、`switch` 等）    | `Repeat`         | 循环语句（如 `for`、`while` 等）     |
  | `Label`        | 标签（如 `case`、`default` 等）             | `Operator`       | 操作符（如 `+`、`-`、`*`、`/` 等）   |
  | `Keyword`      | 关键字（如 `int`、`class` 等）              | `Exception`      | 异常（如 `throw`、`catch` 等）       |
  | `PreProc`      | 预处理器指令（如 `#include`、`#define` 等） | `Include`        | 包含文件（如 `#include` 等）         |
  | `Define`       | 宏定义（如 `#define` 等）                   | `Macro`          | 宏                                   |
  | `PreCondit`    | 预编译条件（如 `#if`、`#ifdef` 等）         | `Type`           | 类型（如 `int`、`char`、`class` 等） |
  | `StorageClass` | 存储类（如 `static`、`extern` 等）          | `Structure`      | 结构体（如 `struct`、`union` 等）    |
  | `Typedef`      | 类型定义（如 `typedef` 等）                 | `Special`        | 特殊符号（如 `\n`、`\t` 等）         |
  | `SpecialChar`  | 特殊字符（如转义字符）                      | `Tag`            | 标签（如 HTML 标签）                 |
  | `Delimiter`    | 分隔符（如 `{`、`}`、`,` 等）               | `SpecialComment` | 特殊注释（如文档注释）               |
  | `Debug`        | 调试信息                                    | `Underlined`     | 下划线文本                           |
  | `Ignore`       | 忽略的文本                                  | `Error`          | 错误信息                             |
  | `Todo`         | TODO 注释                                   |                  |                                      |

- 前景色与背景色：

  - 终端：cterm是”Character Terminal “的缩写，字符终端（字符终端就是常用的bash等终端）。
    - ctermfg：ForeGround，终端前景色。
    - ctermbg：BackGround，终端背景色。
  - gui：vim还除了可以在终端中使用，还提供了gui版本。
    - guifg：gui中的前景色。
    - guibg：gui中的背景色。





# 六、高级功能

## 1. 代码折叠

vim支持代码折叠功能来提高代码效率。在vim中，有关代码折叠的快捷键操作都以`z`开头，例如：`zo`表示折叠展开、`zc`表示折叠收起。

手动折叠代码的步骤为：

- 创建折叠区域：标记一块文本是可折叠的（可折叠区域在展开时与非可折叠区域外观上没什么区别）。
- 展开、关闭折叠区域：对创建的折叠区域进行折叠或者展开。

### 1.1 创建折叠区域

- 手动创建：
  - `zf`：创建折叠区域；
  - `zd`：删除折叠区域。
- 自动创建：设置foldmethod参数来选择折叠区域的创建模式。
  - `manual`：手动创建折叠区域，默认就是这个。
    - 在这个模式下就可以使用`zf`与`zd`来创建和删除折叠区域。
  - `syntax`：根据语法自动生成折叠区域。
    - 例如：如果是c文件，则该模式下vim会根据`{}`来创建折叠区域。
  - `indent`：根据缩进创建折叠区域。
  - `marker`：根据标志创建折叠区域。

说明：

- 折叠区域可以嵌套，因此有层级属性。
  - 折叠区域的层级用数字来标识，数字越大表示层级越深，从1开始；
- 在自动创建模式下：
  - vim不仅会为你目前文件中的内容创建折叠，
  - 还会在你继续编写文件时自动创建折叠区域，
  - 还会在你修改文件时自动调整折叠层级。
  - 但是**自动创建模式下不可以创建与删除折叠区域**。
    - 如果实在要修改折叠区域，只能切换回手动模式。

### 1.2 展开、关闭折叠

展开、关闭折叠区域：

- `zo`：o表示"open"，展开折叠；
- `zc`：c表示"close"，关闭折叠；
- `za`：a表示"alternate"，切换折叠状态；
- `zR`：R表示"recursive"，展开所有折叠；
- `zM`：M表示"maximum"，关闭所有折叠（maximum表示“最大”折叠状态）；
- `zi`：i表示"inverse"，启用/关闭折叠功能。
  - 当关闭折叠功能时，可以让所有的折叠都展开。

---

### 1.3 折叠设置

除了上述命令可以展开/关闭折叠区域，还可以通过设置各项参数设置折叠行为、外观等属性。

- `foldlevel`：设置折叠程度。

  - 格式：`:set foldlevel=整数`

  - 作用：
    - 层级大于`foldlevel`的数值的折叠区域都会被折叠起来。
    - 所以`foldlevel`上数值相当于要展开的层数。
      - 如：`foldlevel=0`，表示所以层级的区域都被折叠起来，也就是所有区域都折叠起来；
      - `foldlevel=1`：第一层的区域被展开（一般是第一层是函数），更深层的区域保持折叠状态。

- `foldenable`：启用折叠

  - 格式：`:set foldenable`
  - 作用：启用折叠。
    - `:set nofoldenable`，关闭折叠功能，此时所有折叠均展开，并且折叠区域都暂时取消。
  - 说明：
    - 使用`zi`命令时，就是在操纵这个参数

- `foldopen`：用于控制在什么情况下会自动展开折叠，其值为条件列表，各条件间用逗号隔开。

  - 格式：`:set foldopen=条件1, [条件2]`
  - 条件：触发自动展开折叠的条件
    - `all`：所有情况下都会展开折叠（默认值）。
    - `block`：在可视模式下选择文本时。
    - `insert`：在插入模式下输入文本时展开折叠。
    - `hor`：水平移动光标时。
    - `mark`：跳转到标记时。
    - `percent`：跳转到文件的百分比位置时。
    - `quickfix`：跳转到quickfix条目时。
    - `search`：搜索时。
    - `tag`：跳转到标签时。
    - `undo`：撤销操作时。
  - `foldclose`：与`foldopen`相反，表示禁用什么自动展开折叠的条件，当`foldclose=all`时，则自动展开完全被禁用。
  
  



## 2. 寄存器

vim中有各种类型的寄存器，如1号寄存器用于保存上次删除的文本，`#`寄存器用于保存上一个编辑的文件名。

### 2.1 引用寄存器

在在命令模式和插入模式中引用寄存器有不同的按键方法：

- 命令模式下：`" + 寄存器名 + 操作`
  - 如：`"2p`，表示并2号寄存器的内容粘粘到当前光标处；
  - `"ayy`：将当前行复制到寄存器a中（a为自定义寄存器）；
  - `”ap`：将寄存器a中的内容粘贴到当前光标处。
- 插入模式：`Ctrl + r` + `寄存器名`，表示将寄存器中的内容插入（粘贴到光标处）
  - 如：`ctrl + r` + `0`，将0号寄存器（上次复制的文本）插入到光标处。

### 2.2 普通寄存器

普通寄存器用于存储最近删除和复制的文本，共有10个，名称为数字0-9：

- `0`：保存最近复制的文本；
- `1-9`：保存最近删除的文本（大于一行，包含换行符`^J`的文本）；
  - 上一次删除的文本保存在1号寄存器中；
  - 如果有新删除的文本，则新删除的文本保存在1号寄存器中，
    - 原1号寄存器中的内容将被转移到2号寄存器，
    - 原2号寄存器中的内容将被转移到3号寄存器中，依此类推。
  - 9个删除寄存器意味着最近9次删除的内容都可以获取到。

### 2.3 自定义寄存器

字母a-z为用户自己使用的寄存器，没有特殊功能，仅仅是用户自己为寄存器指定内容（默认都为空）。

- `"ayw`：将光标处下个单词保存在寄存器a中；
- `"ap`：将寄存器a中的内容粘贴到光标处。

### 2.4 特殊寄存器

除了数字与字母命名的寄存器，还有一些特殊字符命名的、有特殊功能的寄存器：

- `-`：小删除寄存器，保存小于一行（不包含`^J`的文本）的删除内容，如`x`、`dw`操作删除的内容。
- `_`：黑孔寄存器，任何存入到该寄存器的内容都将被直接删除，不可找回。
  - 如：`"_dd`，删除当前行，并不将删除的内容保存在任何寄存器中。
- `"`：无名寄存器，保存上一次删除或复制的文本。
  - `"`寄存器与0号与1号寄存器类似，
    - 但是0号是专门用于保存上次复制的内容，
    - 1号是专门用于保存上次粘贴的内容，
  - 在同一时间，`"`寄存器中的内容要么与1号寄存器一样，要么与0号寄存器一样，要么和`_`寄存器一样。

### 2.5 只读寄存器

vim还提供了一些只读寄存器，用于保存一些关键信息，这些寄存器中的内容不可被更改。

- `"`：上面介绍过了，保存最近删除或者复制的文本；
- `/`：存储最近的搜索模式(parttern)
  - 即：末行模式下的搜索文本。
  - 如：上次在末行模式中的命令为`/hello world`，
  - 则`/`寄存器中的内容为"hello world"。
- `:`：保存最近的命令。
- `%`：保存当前的文件名。
- `#`：保存上一个编辑的文件名。

### 2.6 寄存器内容查看

可以使用命令reg查看各寄存器的内容。

- 格式：`:reg [寄存器名]`
- 例如：
  - `:reg`：查看所有寄存器的内容；
  - `:reg a 1`：查看寄存器a、寄存器1中的内容。

## 3. quickfix

